@model Pyme.Abstracciones.ModelosParaUI.ProductoDto
@{
    ViewBag.Title = "Editar Producto";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="max-w-2xl mx-auto bg-[color:var(--light-panel)] border border-[color:var(--border)] rounded-2xl shadow-sm p-8 mt-10">
    <h1 class="text-2xl font-bold text-[color:var(--txt-primary)] mb-6 flex items-center gap-2">
        <i data-lucide="edit-2" class="w-6 h-6 text-[color:var(--primary)]"></i>
        Editar Producto
    </h1>

    @using (Html.BeginForm("EditarProducto", "Producto", FormMethod.Post, new { @class = "space-y-6" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true, "", new { @class = "text-[color:var(--error)] text-sm" })
        @Html.HiddenFor(m => m.Id)

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
            <div>
                @Html.LabelFor(m => m.Nombre, new { @class = "block text-sm font-medium text-[color:var(--txt-secondary)] mb-2" })
                @Html.TextBoxFor(m => m.Nombre, new { @class = "w-full border border-[color:var(--border)] rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-[color:var(--primary)]", maxlength = 120 })
                @Html.ValidationMessageFor(m => m.Nombre, "", new { @class = "text-[color:var(--error)] text-sm" })
            </div>

            <div>
                @Html.LabelFor(m => m.CategoriaId, new { @class = "block text-sm font-medium text-[color:var(--txt-secondary)] mb-2" })
                @Html.TextBoxFor(m => m.CategoriaId, new { @class = "w-full border border-[color:var(--border)] rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-[color:var(--primary)]", type = "number", min = "1", placeholder = "Id de categoría" })
                @Html.ValidationMessageFor(m => m.CategoriaId, "", new { @class = "text-[color:var(--error)] text-sm" })
            </div>

            <div>
                @Html.LabelFor(m => m.Precio, new { @class = "block text-sm font-medium text-[color:var(--txt-secondary)] mb-2" })
                @Html.TextBoxFor(m => m.Precio, new { @class = "w-full border border-[color:var(--border)] rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-[color:var(--primary)]", type = "number", step = "0.01", min = "0" })
                @Html.ValidationMessageFor(m => m.Precio, "", new { @class = "text-[color:var(--error)] text-sm" })
            </div>

            <div>
                @Html.LabelFor(m => m.ImpuestoPorc, new { @class = "block text-sm font-medium text-[color:var(--txt-secondary)] mb-2" })
                @Html.TextBoxFor(m => m.ImpuestoPorc, new { @class = "w-full border border-[color:var(--border)] rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-[color:var(--primary)]", type = "number", step = "0.01", min = "0", max = "100" })
                @Html.ValidationMessageFor(m => m.ImpuestoPorc, "", new { @class = "text-[color:var(--error)] text-sm" })
            </div>

            <div>
                @Html.LabelFor(m => m.Stock, new { @class = "block text-sm font-medium text-[color:var(--txt-secondary)] mb-2" })
                @Html.TextBoxFor(m => m.Stock, new { @class = "w-full border border-[color:var(--border)] rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-[color:var(--primary)]", type = "number", min = "0" })
                @Html.ValidationMessageFor(m => m.Stock, "", new { @class = "text-[color:var(--error)] text-sm" })
            </div>

            <div class="sm:col-span-2">
                @Html.LabelFor(m => m.ImagenUrl, new { @class = "block text-sm font-medium text-[color:var(--txt-secondary)] mb-2" })
                @Html.TextBoxFor(m => m.ImagenUrl, new { @class = "w-full border border-[color:var(--border)] rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-[color:var(--primary)]", type = "url", maxlength = 400, placeholder = "https://..." })
                @Html.ValidationMessageFor(m => m.ImagenUrl, "", new { @class = "text-[color:var(--error)] text-sm" })

                @if (!string.IsNullOrWhiteSpace(Model.ImagenUrl))
                {
                    <div class="mt-3">
                        <img src="@Model.ImagenUrl" alt="@Model.Nombre" class="w-20 h-20 rounded-lg object-cover border border-[color:var(--border)]" />
                    </div>
                }
            </div>

            <div class="sm:col-span-2">
                <label class="inline-flex items-center gap-2">
                    @Html.CheckBoxFor(m => m.EstadoProducto)
                    <span>@Html.DisplayNameFor(m => m.EstadoProducto)</span>
                </label>
                @Html.ValidationMessageFor(m => m.EstadoProducto, "", new { @class = "text-[color:var(--error)] text-sm" })
            </div>
        </div>

        <div class="mt-8 flex justify-end gap-4">
            @Html.ActionLink("Cancelar", "ListarProducto", "Producto", null, new { @class = "px-5 py-2.5 border border-[color:var(--border)] text-[color:var(--txt-secondary)] rounded-xl hover:bg-[color:var(--light-bg)] transition-colors" })
            <button type="submit" class="px-5 py-2.5 bg-[color:var(--primary)] text-white font-medium rounded-xl hover:bg-[color:var(--primary-dark)] transition-colors flex items-center gap-2">
                <i data-lucide="save" class="w-5 h-5"></i> Guardar Cambios
            </button>
        </div>
    }
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
